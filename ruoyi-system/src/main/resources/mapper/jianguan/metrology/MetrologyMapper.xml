<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.ruoyi.jianguan.metrology.mapper.MetrologyMapper">

    <!-- 通用查询映射结果 -->
    <resultMap id="BaseResultMap" type="com.ruoyi.jianguan.metrology.domain.entity.Metrology">
        <id column="id" property="id" />
        <result column="metrology_name" property="metrologyName" />
        <result column="start_date" property="startDate" />
        <result column="end_date" property="endDate" />
        <result column="metrology_no" property="metrologyNo" />
        <result column="apply_date" property="applyDate" />
        <result column="apply_unit" property="applyUnit" />
        <result column="amount" property="amount" />
        <result column="content" property="content" />
        <result column="apply_certificate" property="applyCertificate" />
        <result column="audit_status" property="auditStatus" />
        <result column="attachment" property="attachment" />
        <result column="project_id" property="projectId" />
        <result column="sttime" property="sttime" />
        <result column="ststate" property="ststate" />
        <result column="storder" property="storder" />
    </resultMap>

    <!-- 通用查询结果列 -->
    <sql id="Base_Column_List">
        id,metrology_name,start_date,end_date,metrology_no,apply_date,apply_unit,amount,content,apply_certificate,audit_status,attachment,project_id,sttime,ststate,storder
    </sql>

    <select id="getPageInfo" resultType="com.ruoyi.jianguan.metrology.domain.vo.MetrologyPageVo" parameterType="com.ruoyi.jianguan.metrology.domain.dto.MetrologyPageDTO">
        select id,
               metrology_name as metrologyName,
               start_date as startDate,
               end_date as endDate,
               metrology_no as metrologyNo,
               apply_date as applyDate,
               apply_unit as applyUnit,
               amount,
               content,
               apply_certificate as applyCertificate,
               audit_status as auditStatus,
               attachment,
               project_id as projectId,
               sttime,
               ststate,
               storder
        from zz_metrology a
        <where>
            a.project_id = #{pageDto.projectId}
            <if test="pageDto.metrologyNo != null and pageDto.metrologyNo != ''">
                and a.metrology_no like concat('%',#{pageDto.metrologyNo},'%')
            </if>
            <if test="pageDto.applyUnit != null and pageDto.applyUnit != ''">
                and a.apply_unit like concat('%',#{pageDto.applyUnit},'%')
            </if>
        </where>
        order by create_time desc
    </select>

</mapper>
